{"episode_reward_max": 37.198361691858274, "episode_reward_min": 26.23869879702037, "episode_reward_mean": 31.41535073765291, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1227.8282518664741, "mean_processing_ms": 124.56136752971116, "mean_inference_ms": 1.124593122003768}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6912, "num_steps_sampled": 7000, "sample_time_ms": 287517.515, "load_time_ms": 33.697, "grad_time_ms": 1294.189, "update_time_ms": 352.905, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-06, "total_loss": 91.7920913696289, "policy_loss": -0.00425912206992507, "vf_loss": 91.79607391357422, "vf_explained_var": -0.0011711484985426068, "kl": 0.0014396412298083305, "entropy": 2.826922655105591, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 7000, "episodes_total": 105, "training_iteration": 1, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_21-35-54", "timestamp": 1624592154, "time_this_iter_s": 289.23561096191406, "time_total_s": 289.23561096191406, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 289.23561096191406, "timesteps_since_restore": 7000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 87.3912832929782, "ram_util_percent": 29.156174334140434}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 36.35420575837853, "episode_reward_min": 28.75054406896816, "episode_reward_mean": 31.85383061017175, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1225.4068196945273, "mean_processing_ms": 125.6396428860079, "mean_inference_ms": 1.0590026333614904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13824, "num_steps_sampled": 14000, "sample_time_ms": 282138.162, "load_time_ms": 17.939, "grad_time_ms": 919.793, "update_time_ms": 178.564, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": 83.82559204101562, "policy_loss": -0.006204103585332632, "vf_loss": 83.83129119873047, "vf_explained_var": -0.004420595243573189, "kl": 0.004863262176513672, "entropy": 2.848690986633301, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 14000, "episodes_total": 210, "training_iteration": 2, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_21-40-32", "timestamp": 1624592432, "time_this_iter_s": 277.3305699825287, "time_total_s": 566.5661809444427, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 566.5661809444427, "timesteps_since_restore": 14000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 88.94974747474747, "ram_util_percent": 31.984343434343433}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 40.066588576504685, "episode_reward_min": 28.69263260283058, "episode_reward_mean": 33.18965296780885, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1226.3265918942961, "mean_processing_ms": 126.24119898472144, "mean_inference_ms": 1.0455259949230993}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20736, "num_steps_sampled": 21000, "sample_time_ms": 281170.361, "load_time_ms": 12.592, "grad_time_ms": 808.74, "update_time_ms": 120.42, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-06, "total_loss": 84.08950805664062, "policy_loss": -0.0035934012848883867, "vf_loss": 84.0927734375, "vf_explained_var": -0.008162272162735462, "kl": 0.006572553887963295, "entropy": 2.8399267196655273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 21000, "episodes_total": 315, "training_iteration": 3, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_21-45-11", "timestamp": 1624592711, "time_this_iter_s": 279.84249114990234, "time_total_s": 846.4086720943451, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 846.4086720943451, "timesteps_since_restore": 21000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 88.71528822055139, "ram_util_percent": 32.235588972431074}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 38.25268536148928, "episode_reward_min": 29.664836759404068, "episode_reward_mean": 33.684445198631906, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1230.078355679649, "mean_processing_ms": 126.75564662007397, "mean_inference_ms": 1.0339675792423995}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27648, "num_steps_sampled": 28000, "sample_time_ms": 281020.642, "load_time_ms": 10.075, "grad_time_ms": 768.082, "update_time_ms": 91.355, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999747378752e-06, "total_loss": 82.59494018554688, "policy_loss": -0.004769983701407909, "vf_loss": 82.59962463378906, "vf_explained_var": -0.007699714973568916, "kl": 0.003704656148329377, "entropy": 2.82016921043396, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 28000, "episodes_total": 420, "training_iteration": 4, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_21-49-53", "timestamp": 1624592993, "time_this_iter_s": 281.3307809829712, "time_total_s": 1127.7394530773163, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1127.7394530773163, "timesteps_since_restore": 28000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 89.1281795511222, "ram_util_percent": 32.37655860349127}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 38.950140360408824, "episode_reward_min": 28.842964940501002, "episode_reward_mean": 34.82623601185343, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1233.5224302957959, "mean_processing_ms": 127.10397157414556, "mean_inference_ms": 1.0310411283118213}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34560, "num_steps_sampled": 35000, "sample_time_ms": 280899.161, "load_time_ms": 8.596, "grad_time_ms": 739.065, "update_time_ms": 73.917, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999747378752e-06, "total_loss": 85.26873779296875, "policy_loss": -0.0035658085253089666, "vf_loss": 85.27223205566406, "vf_explained_var": -0.005042196251451969, "kl": 0.004211464896798134, "entropy": 2.797868013381958, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 35000, "episodes_total": 525, "training_iteration": 5, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_21-54-34", "timestamp": 1624593274, "time_this_iter_s": 281.0589065551758, "time_total_s": 1408.798359632492, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1408.798359632492, "timesteps_since_restore": 35000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 89.34502487562189, "ram_util_percent": 32.45771144278607}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 39.30829864149881, "episode_reward_min": 31.20146571126466, "episode_reward_mean": 35.47612481676919, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1237.7299105609175, "mean_processing_ms": 127.57004060855276, "mean_inference_ms": 1.0241147296896895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41472, "num_steps_sampled": 42000, "sample_time_ms": 281567.192, "load_time_ms": 10.043, "grad_time_ms": 718.412, "update_time_ms": 62.299, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999747378752e-06, "total_loss": 88.84785461425781, "policy_loss": -0.0023744788486510515, "vf_loss": 88.8501968383789, "vf_explained_var": -0.0028165688272565603, "kl": 0.004127438645809889, "entropy": 2.795457601547241, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 42000, "episodes_total": 630, "training_iteration": 6, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_21-59-20", "timestamp": 1624593560, "time_this_iter_s": 285.66322660446167, "time_total_s": 1694.4615862369537, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1694.4615862369537, "timesteps_since_restore": 42000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 89.092628992629, "ram_util_percent": 32.59680589680589}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 39.331541243407884, "episode_reward_min": 30.983512782301766, "episode_reward_mean": 35.98239397623271, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1240.5663408950597, "mean_processing_ms": 127.8531065091234, "mean_inference_ms": 1.0229591298835095}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48384, "num_steps_sampled": 49000, "sample_time_ms": 281710.501, "load_time_ms": 9.001, "grad_time_ms": 705.459, "update_time_ms": 53.989, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999747378752e-06, "total_loss": 99.22332000732422, "policy_loss": -0.00509119126945734, "vf_loss": 99.2283706665039, "vf_explained_var": -0.0021369445603340864, "kl": 0.008146177977323532, "entropy": 2.7760989665985107, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 49000, "episodes_total": 735, "training_iteration": 7, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-04-03", "timestamp": 1624593843, "time_this_iter_s": 283.21989345550537, "time_total_s": 1977.681479692459, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1977.681479692459, "timesteps_since_restore": 49000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 89.63069306930694, "ram_util_percent": 32.64554455445544}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 41.52206691896476, "episode_reward_min": 33.2094137914716, "episode_reward_mean": 37.67583381311861, "episode_len_mean": 64.0, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1245.1489441824754, "mean_processing_ms": 133.50550028304937, "mean_inference_ms": 1.0195876525132783}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55296, "num_steps_sampled": 56000, "sample_time_ms": 283912.607, "load_time_ms": 8.157, "grad_time_ms": 693.443, "update_time_ms": 47.751, "learner": {"default_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 107.94239044189453, "policy_loss": -0.00315985269844532, "vf_loss": 107.945556640625, "vf_explained_var": 0.0003035223053302616, "kl": 0.004184814170002937, "entropy": 2.724982976913452, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 56000, "episodes_total": 875, "training_iteration": 8, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-09-03", "timestamp": 1624594143, "time_this_iter_s": 300.04612922668457, "time_total_s": 2277.7276089191437, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2277.7276089191437, "timesteps_since_restore": 56000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 88.33855140186914, "ram_util_percent": 32.73598130841121}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 42.56413945028195, "episode_reward_min": 34.74060160602916, "episode_reward_mean": 38.299818745148755, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1246.3521912274377, "mean_processing_ms": 133.19127569685014, "mean_inference_ms": 1.017251400127942}, "off_policy_estimator": {}, "info": {"num_steps_trained": 62208, "num_steps_sampled": 63000, "sample_time_ms": 284556.086, "load_time_ms": 7.487, "grad_time_ms": 686.72, "update_time_ms": 42.943, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 9.999999747378752e-06, "total_loss": 110.45111846923828, "policy_loss": -0.006283878814429045, "vf_loss": 110.45738983154297, "vf_explained_var": -0.0002657450968399644, "kl": 0.004791422747075558, "entropy": 2.7142865657806396, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 63000, "episodes_total": 980, "training_iteration": 9, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-13-54", "timestamp": 1624594434, "time_this_iter_s": 290.35912585258484, "time_total_s": 2568.0867347717285, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2568.0867347717285, "timesteps_since_restore": 63000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 87.58695652173913, "ram_util_percent": 32.76014492753623}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 43.17016248148991, "episode_reward_min": 34.95905495385306, "episode_reward_mean": 38.94693965039997, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1248.7510750974077, "mean_processing_ms": 133.12584403547237, "mean_inference_ms": 1.0181221281460013}, "off_policy_estimator": {}, "info": {"num_steps_trained": 69120, "num_steps_sampled": 70000, "sample_time_ms": 285284.447, "load_time_ms": 6.977, "grad_time_ms": 680.636, "update_time_ms": 39.066, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 9.999999747378752e-06, "total_loss": 104.39562225341797, "policy_loss": -0.005799140315502882, "vf_loss": 104.40140533447266, "vf_explained_var": 0.0002744551165960729, "kl": 0.007676989771425724, "entropy": 2.6488566398620605, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 70000, "episodes_total": 1085, "training_iteration": 10, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-18-46", "timestamp": 1624594726, "time_this_iter_s": 292.55903840065, "time_total_s": 2860.6457731723785, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2860.6457731723785, "timesteps_since_restore": 70000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 87.9031100478469, "ram_util_percent": 32.98133971291866}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 43.728996468557916, "episode_reward_min": 36.68304482613881, "episode_reward_mean": 39.8692816711758, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1250.70538797191, "mean_processing_ms": 133.0669559463409, "mean_inference_ms": 1.0157442529281822}, "off_policy_estimator": {}, "info": {"num_steps_trained": 76032, "num_steps_sampled": 77000, "sample_time_ms": 285628.175, "load_time_ms": 3.975, "grad_time_ms": 613.463, "update_time_ms": 4.188, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 9.999999747378752e-06, "total_loss": 103.2698745727539, "policy_loss": -0.005316744092851877, "vf_loss": 103.27518463134766, "vf_explained_var": -0.0003604105149861425, "kl": 0.009126256220042706, "entropy": 2.601823329925537, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 77000, "episodes_total": 1190, "training_iteration": 11, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-23-38", "timestamp": 1624595018, "time_this_iter_s": 291.5993700027466, "time_total_s": 3152.245143175125, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3152.245143175125, "timesteps_since_restore": 77000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 88.31514423076922, "ram_util_percent": 33.068028846153844}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 44.10905854051477, "episode_reward_min": 37.780571512181716, "episode_reward_mean": 40.855145677559484, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1253.0306527564521, "mean_processing_ms": 133.07836193498483, "mean_inference_ms": 1.0155271432667432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 82944, "num_steps_sampled": 84000, "sample_time_ms": 287601.705, "load_time_ms": 3.991, "grad_time_ms": 620.676, "update_time_ms": 4.155, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 104.64985656738281, "policy_loss": -0.0019721740391105413, "vf_loss": 104.65184783935547, "vf_explained_var": 0.0002770655555650592, "kl": 0.0016911374405026436, "entropy": 2.5796172618865967, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 84000, "episodes_total": 1295, "training_iteration": 12, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-28-35", "timestamp": 1624595315, "time_this_iter_s": 297.2874128818512, "time_total_s": 3449.5325560569763, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3449.5325560569763, "timesteps_since_restore": 84000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 87.27617924528302, "ram_util_percent": 33.18231132075472}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 43.97922579234796, "episode_reward_min": 38.426413362039824, "episode_reward_mean": 41.17156877055379, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1255.4009906253173, "mean_processing_ms": 133.12113250625148, "mean_inference_ms": 1.0143838238073166}, "off_policy_estimator": {}, "info": {"num_steps_trained": 89856, "num_steps_sampled": 91000, "sample_time_ms": 288955.129, "load_time_ms": 4.17, "grad_time_ms": 624.626, "update_time_ms": 4.17, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 106.36072540283203, "policy_loss": -0.0017064128769561648, "vf_loss": 106.36241912841797, "vf_explained_var": 0.0003532645932864398, "kl": 0.003451925003901124, "entropy": 2.5950469970703125, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 91000, "episodes_total": 1400, "training_iteration": 13, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-33-29", "timestamp": 1624595609, "time_this_iter_s": 293.4186940193176, "time_total_s": 3742.951250076294, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3742.951250076294, "timesteps_since_restore": 91000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 88.75478468899522, "ram_util_percent": 33.31291866028708}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 43.441499531717405, "episode_reward_min": 37.204467533541134, "episode_reward_mean": 40.9101129545605, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1258.0714108304694, "mean_processing_ms": 133.11540599065583, "mean_inference_ms": 1.0146469417386608}, "off_policy_estimator": {}, "info": {"num_steps_trained": 96768, "num_steps_sampled": 98000, "sample_time_ms": 290401.297, "load_time_ms": 4.142, "grad_time_ms": 622.785, "update_time_ms": 4.185, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 107.70441436767578, "policy_loss": -0.003352454164996743, "vf_loss": 107.70777893066406, "vf_explained_var": 0.00022527907276526093, "kl": 0.0030686971731483936, "entropy": 2.596654176712036, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 98000, "episodes_total": 1505, "training_iteration": 14, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-38-24", "timestamp": 1624595904, "time_this_iter_s": 295.688214302063, "time_total_s": 4038.639464378357, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4038.639464378357, "timesteps_since_restore": 98000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 88.39454976303317, "ram_util_percent": 33.27582938388626}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 43.80570887386809, "episode_reward_min": 36.56044497199458, "episode_reward_mean": 41.152760806684526, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1259.834265253809, "mean_processing_ms": 133.13083294123808, "mean_inference_ms": 1.0182697167938823}, "off_policy_estimator": {}, "info": {"num_steps_trained": 103680, "num_steps_sampled": 105000, "sample_time_ms": 291924.985, "load_time_ms": 4.207, "grad_time_ms": 621.975, "update_time_ms": 4.211, "learner": {"default_policy": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 117.50306701660156, "policy_loss": -0.002699893433600664, "vf_loss": 117.5057601928711, "vf_explained_var": -2.7947955459239893e-05, "kl": 0.005448657553642988, "entropy": 2.5526483058929443, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 105000, "episodes_total": 1610, "training_iteration": 15, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-43-21", "timestamp": 1624596201, "time_this_iter_s": 296.2902104854584, "time_total_s": 4334.929674863815, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4334.929674863815, "timesteps_since_restore": 105000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 87.7498817966903, "ram_util_percent": 33.3290780141844}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 44.581404402080885, "episode_reward_min": 39.05072285454033, "episode_reward_mean": 41.8150095878592, "episode_len_mean": 64.0, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1262.4026828178862, "mean_processing_ms": 135.84035034399304, "mean_inference_ms": 1.0181832931742596}, "off_policy_estimator": {}, "info": {"num_steps_trained": 110592, "num_steps_sampled": 112000, "sample_time_ms": 294042.231, "load_time_ms": 2.702, "grad_time_ms": 622.56, "update_time_ms": 4.188, "learner": {"default_policy": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 120.98922729492188, "policy_loss": -0.0003092375991400331, "vf_loss": 120.98954772949219, "vf_explained_var": 2.7718368073692545e-05, "kl": 0.006679054815322161, "entropy": 2.51656174659729, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 112000, "episodes_total": 1750, "training_iteration": 16, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-48-28", "timestamp": 1624596508, "time_this_iter_s": 306.73905754089355, "time_total_s": 4641.668732404709, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4641.668732404709, "timesteps_since_restore": 112000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 88.21922196796339, "ram_util_percent": 33.35812356979406}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 45.30206308319306, "episode_reward_min": 39.78179620049042, "episode_reward_mean": 42.37479442516768, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1263.714303696737, "mean_processing_ms": 135.74123634737043, "mean_inference_ms": 1.0177296442882784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 117504, "num_steps_sampled": 119000, "sample_time_ms": 295130.457, "load_time_ms": 4.914, "grad_time_ms": 620.794, "update_time_ms": 4.19, "learner": {"default_policy": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 121.858642578125, "policy_loss": -0.005243046209216118, "vf_loss": 121.86388397216797, "vf_explained_var": 2.688831727937213e-06, "kl": 0.007060539443045855, "entropy": 2.4909090995788574, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 119000, "episodes_total": 1855, "training_iteration": 17, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-53-22", "timestamp": 1624596802, "time_this_iter_s": 294.10644459724426, "time_total_s": 4935.775177001953, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 4935.775177001953, "timesteps_since_restore": 119000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 88.47785714285713, "ram_util_percent": 33.385238095238094}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 45.659520209844196, "episode_reward_min": 40.18646063989109, "episode_reward_mean": 42.844738673823414, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1265.3125161969895, "mean_processing_ms": 135.7271451594815, "mean_inference_ms": 1.0167346089769773}, "off_policy_estimator": {}, "info": {"num_steps_trained": 124416, "num_steps_sampled": 126000, "sample_time_ms": 294861.672, "load_time_ms": 4.898, "grad_time_ms": 620.215, "update_time_ms": 4.218, "learner": {"default_policy": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 113.83203125, "policy_loss": -0.0031759869307279587, "vf_loss": 113.83519744873047, "vf_explained_var": 8.177536801667884e-05, "kl": 0.004004735965281725, "entropy": 2.444526195526123, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 126000, "episodes_total": 1960, "training_iteration": 18, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_22-58-19", "timestamp": 1624597099, "time_this_iter_s": 297.269145488739, "time_total_s": 5233.044322490692, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5233.044322490692, "timesteps_since_restore": 126000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 88.33443396226416, "ram_util_percent": 33.675000000000004}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 45.970265114754405, "episode_reward_min": 41.30902216959355, "episode_reward_mean": 43.49528079307726, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1266.4825969355825, "mean_processing_ms": 135.65343146116805, "mean_inference_ms": 1.0162102560961705}, "off_policy_estimator": {}, "info": {"num_steps_trained": 131328, "num_steps_sampled": 133000, "sample_time_ms": 295323.673, "load_time_ms": 4.937, "grad_time_ms": 618.973, "update_time_ms": 4.183, "learner": {"default_policy": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 9.999999747378752e-06, "total_loss": 110.38725280761719, "policy_loss": -0.0004310093936510384, "vf_loss": 110.3876953125, "vf_explained_var": -1.0949594297926524e-06, "kl": 0.0033172706607729197, "entropy": 2.391263723373413, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 133000, "episodes_total": 2065, "training_iteration": 19, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-03-14", "timestamp": 1624597394, "time_this_iter_s": 294.9662654399872, "time_total_s": 5528.010587930679, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5528.010587930679, "timesteps_since_restore": 133000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 88.5187648456057, "ram_util_percent": 33.629216152019005}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 45.905602569655215, "episode_reward_min": 41.075395729126235, "episode_reward_mean": 43.75143599808249, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1267.9516468214267, "mean_processing_ms": 135.65201781812226, "mean_inference_ms": 1.01571360246301}, "off_policy_estimator": {}, "info": {"num_steps_trained": 138240, "num_steps_sampled": 140000, "sample_time_ms": 296096.806, "load_time_ms": 4.918, "grad_time_ms": 616.388, "update_time_ms": 4.176, "learner": {"default_policy": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 9.999999747378752e-06, "total_loss": 108.69166564941406, "policy_loss": 0.0016333551611751318, "vf_loss": 108.69002532958984, "vf_explained_var": 5.3836240113014355e-05, "kl": 0.003690506098791957, "entropy": 2.351464033126831, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 140000, "episodes_total": 2170, "training_iteration": 20, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-08-15", "timestamp": 1624597695, "time_this_iter_s": 300.34870982170105, "time_total_s": 5828.35929775238, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 5828.35929775238, "timesteps_since_restore": 140000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 87.72126168224298, "ram_util_percent": 33.68411214953271}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 46.25108985120735, "episode_reward_min": 41.12860640252946, "episode_reward_mean": 44.22129184591826, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1269.6825908399242, "mean_processing_ms": 135.68062684834905, "mean_inference_ms": 1.0155289411569122}, "off_policy_estimator": {}, "info": {"num_steps_trained": 145152, "num_steps_sampled": 147000, "sample_time_ms": 296967.706, "load_time_ms": 4.774, "grad_time_ms": 616.178, "update_time_ms": 4.206, "learner": {"default_policy": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 9.999999747378752e-06, "total_loss": 112.28543090820312, "policy_loss": -0.0019913611467927694, "vf_loss": 112.28742218017578, "vf_explained_var": 1.5155032997427043e-05, "kl": 0.004142496734857559, "entropy": 2.3252925872802734, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 147000, "episodes_total": 2275, "training_iteration": 21, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-13-15", "timestamp": 1624597995, "time_this_iter_s": 300.3073740005493, "time_total_s": 6128.66667175293, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6128.66667175293, "timesteps_since_restore": 147000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 88.08857808857809, "ram_util_percent": 33.78904428904429}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 47.05904422438908, "episode_reward_min": 40.99159768572703, "episode_reward_mean": 44.32893637839825, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1271.3937650370915, "mean_processing_ms": 135.68310586852118, "mean_inference_ms": 1.0157640788201234}, "off_policy_estimator": {}, "info": {"num_steps_trained": 152064, "num_steps_sampled": 154000, "sample_time_ms": 297312.525, "load_time_ms": 4.941, "grad_time_ms": 615.987, "update_time_ms": 4.226, "learner": {"default_policy": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 119.20682525634766, "policy_loss": -0.00541925011202693, "vf_loss": 119.21224212646484, "vf_explained_var": 2.1149715394130908e-05, "kl": 0.0077210175804793835, "entropy": 2.264770030975342, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 154000, "episodes_total": 2380, "training_iteration": 22, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-18-16", "timestamp": 1624598296, "time_this_iter_s": 300.74189376831055, "time_total_s": 6429.40856552124, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6429.40856552124, "timesteps_since_restore": 154000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 88.18648018648018, "ram_util_percent": 33.821445221445224}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 47.48894752148687, "episode_reward_min": 42.80573533281288, "episode_reward_mean": 44.798094953260176, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1273.213154926064, "mean_processing_ms": 135.7621134983837, "mean_inference_ms": 1.0144211199422253}, "off_policy_estimator": {}, "info": {"num_steps_trained": 158976, "num_steps_sampled": 161000, "sample_time_ms": 298140.699, "load_time_ms": 4.802, "grad_time_ms": 614.591, "update_time_ms": 4.23, "learner": {"default_policy": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 131.93475341796875, "policy_loss": -0.0027123766485601664, "vf_loss": 131.93748474121094, "vf_explained_var": 3.7230827274470357e-06, "kl": 0.0018319508526474237, "entropy": 2.233799695968628, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 161000, "episodes_total": 2485, "training_iteration": 23, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-23-17", "timestamp": 1624598597, "time_this_iter_s": 301.6862404346466, "time_total_s": 6731.094805955887, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 6731.094805955887, "timesteps_since_restore": 161000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 88.50534883720931, "ram_util_percent": 33.9246511627907}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 46.76328426967281, "episode_reward_min": 42.40914350111395, "episode_reward_mean": 45.016454684176644, "episode_len_mean": 64.0, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1276.0524051632888, "mean_processing_ms": 137.6902827455475, "mean_inference_ms": 1.014101797919955}, "off_policy_estimator": {}, "info": {"num_steps_trained": 165888, "num_steps_sampled": 168000, "sample_time_ms": 300230.155, "load_time_ms": 9.255, "grad_time_ms": 616.236, "update_time_ms": 4.202, "learner": {"default_policy": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 129.2679901123047, "policy_loss": -0.0030366522260010242, "vf_loss": 129.27102661132812, "vf_explained_var": 1.0440747246320825e-05, "kl": 0.0024081538431346416, "entropy": 2.2100391387939453, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 168000, "episodes_total": 2625, "training_iteration": 24, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-28-34", "timestamp": 1624598914, "time_this_iter_s": 316.6463272571564, "time_total_s": 7047.741133213043, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7047.741133213043, "timesteps_since_restore": 168000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 88.03517699115044, "ram_util_percent": 33.932079646017705}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 47.223988842709225, "episode_reward_min": 43.14670142392352, "episode_reward_mean": 45.2074699958253, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1277.2218871246723, "mean_processing_ms": 137.6558662070425, "mean_inference_ms": 1.014362790098492}, "off_policy_estimator": {}, "info": {"num_steps_trained": 172800, "num_steps_sampled": 175000, "sample_time_ms": 300905.095, "load_time_ms": 9.153, "grad_time_ms": 617.536, "update_time_ms": 4.244, "learner": {"default_policy": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 127.82437896728516, "policy_loss": -0.004357611760497093, "vf_loss": 127.82872772216797, "vf_explained_var": 1.1755359992093872e-06, "kl": 0.007243015803396702, "entropy": 2.149991989135742, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 175000, "episodes_total": 2730, "training_iteration": 25, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-33-37", "timestamp": 1624599217, "time_this_iter_s": 303.07254672050476, "time_total_s": 7350.813679933548, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7350.813679933548, "timesteps_since_restore": 175000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 87.56041666666668, "ram_util_percent": 34.043055555555554}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
{"episode_reward_max": 46.97987583306677, "episode_reward_min": 43.44874251207252, "episode_reward_mean": 45.52958536259674, "episode_len_mean": 64.0, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 1278.7045669636868, "mean_processing_ms": 137.68488926172, "mean_inference_ms": 1.013748356395347}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179712, "num_steps_sampled": 182000, "sample_time_ms": 301664.695, "load_time_ms": 9.163, "grad_time_ms": 619.931, "update_time_ms": 4.308, "learner": {"default_policy": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 9.999999747378752e-06, "total_loss": 118.531005859375, "policy_loss": -0.0034069374669343233, "vf_loss": 118.534423828125, "vf_explained_var": 3.1303477499022847e-06, "kl": 0.004177570343017578, "entropy": 2.0949831008911133, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 182000, "episodes_total": 2835, "training_iteration": 26, "experiment_id": "d2c7ecec4fd948e7b3258103e6865a20", "date": "2021-06-24_23-38-52", "timestamp": 1624599532, "time_this_iter_s": 314.35901165008545, "time_total_s": 7665.172691583633, "pid": 65858, "hostname": "r1i6n9", "node_ip": "10.148.1.19", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 64, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 80,\n            \"horizon\": 64,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 2,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 80,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 64,\n        \"sims_per_step\": 80,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 7665.172691583633, "timesteps_since_restore": 182000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 85.34776785714287, "ram_util_percent": 34.10200892857143}, "num_healthy_workers": 35, "trial_id": "bb9bae7c", "experiment_tag": "0"}
