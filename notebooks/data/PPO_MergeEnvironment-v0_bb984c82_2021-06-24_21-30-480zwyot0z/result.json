{"episode_reward_max": 74.69239349027995, "episode_reward_min": 63.0731207991547, "episode_reward_mean": 68.35465234567329, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 599.5059060813182, "mean_processing_ms": 33.97260484919111, "mean_inference_ms": 1.1169202122691684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 6912, "num_steps_sampled": 7000, "sample_time_ms": 141794.918, "load_time_ms": 33.529, "grad_time_ms": 858.008, "update_time_ms": 420.905, "learner": {"default_policy": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 9.999999747378752e-06, "total_loss": 164.31661987304688, "policy_loss": -0.0005991122452542186, "vf_loss": 164.31715393066406, "vf_explained_var": -0.00010517350165173411, "kl": 0.00036606439971365035, "entropy": 2.8313283920288086, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 7000, "episodes_total": 35, "training_iteration": 1, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_21-46-33", "timestamp": 1624592793, "time_this_iter_s": 143.1382954120636, "time_total_s": 143.1382954120636, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 143.1382954120636, "timesteps_since_restore": 7000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 84.3039024390244, "ram_util_percent": 28.21658536585366}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 76.95821249035868, "episode_reward_min": 58.9623164448071, "episode_reward_mean": 68.03025621776324, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 604.0115696073098, "mean_processing_ms": 46.44410533015616, "mean_inference_ms": 1.0680292414692447}, "off_policy_estimator": {}, "info": {"num_steps_trained": 13824, "num_steps_sampled": 14000, "sample_time_ms": 141344.604, "load_time_ms": 17.617, "grad_time_ms": 701.433, "update_time_ms": 212.551, "learner": {"default_policy": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 9.999999747378752e-06, "total_loss": 142.54946899414062, "policy_loss": -0.0027093125972896814, "vf_loss": 142.55201721191406, "vf_explained_var": -0.0036281005013734102, "kl": 0.0018384511349722743, "entropy": 2.828536033630371, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 14000, "episodes_total": 105, "training_iteration": 2, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_21-48-54", "timestamp": 1624592934, "time_this_iter_s": 141.46039938926697, "time_total_s": 284.59869480133057, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 284.59869480133057, "timesteps_since_restore": 14000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 88.00495049504953, "ram_util_percent": 32.37376237623762}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 76.95821249035868, "episode_reward_min": 58.9623164448071, "episode_reward_mean": 68.36820148322208, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 606.4509888421863, "mean_processing_ms": 49.87164395878845, "mean_inference_ms": 1.0397105781841705}, "off_policy_estimator": {}, "info": {"num_steps_trained": 20736, "num_steps_sampled": 21000, "sample_time_ms": 138420.134, "load_time_ms": 12.643, "grad_time_ms": 651.738, "update_time_ms": 143.082, "learner": {"default_policy": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 9.999999747378752e-06, "total_loss": 158.2033233642578, "policy_loss": -0.0006414572126232088, "vf_loss": 158.20384216308594, "vf_explained_var": -0.0066303652711212635, "kl": 0.0022130790166556835, "entropy": 2.830235004425049, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 21000, "episodes_total": 140, "training_iteration": 3, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_21-51-08", "timestamp": 1624593068, "time_this_iter_s": 133.14584851264954, "time_total_s": 417.7445433139801, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 417.7445433139801, "timesteps_since_restore": 21000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 89.05608465608465, "ram_util_percent": 32.44708994708995}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 76.64707593683538, "episode_reward_min": 62.82808252415898, "episode_reward_mean": 70.22059658055366, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 607.3862093531559, "mean_processing_ms": 50.60899198322336, "mean_inference_ms": 1.0233704623480562}, "off_policy_estimator": {}, "info": {"num_steps_trained": 27648, "num_steps_sampled": 28000, "sample_time_ms": 139157.785, "load_time_ms": 9.945, "grad_time_ms": 625.845, "update_time_ms": 108.36, "learner": {"default_policy": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 9.999999747378752e-06, "total_loss": 142.89405822753906, "policy_loss": -0.0004583842819556594, "vf_loss": 142.8944854736328, "vf_explained_var": -0.002782531315460801, "kl": 0.000636774580925703, "entropy": 2.8037571907043457, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 28000, "episodes_total": 210, "training_iteration": 4, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_21-53-30", "timestamp": 1624593210, "time_this_iter_s": 142.00710654258728, "time_total_s": 559.7516498565674, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 559.7516498565674, "timesteps_since_restore": 28000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 87.42019704433498, "ram_util_percent": 32.48226600985222}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 76.68987950867894, "episode_reward_min": 62.82808252415898, "episode_reward_mean": 70.90680314173581, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 608.0270859487014, "mean_processing_ms": 51.26477095970346, "mean_inference_ms": 1.0142222657152213}, "off_policy_estimator": {}, "info": {"num_steps_trained": 34560, "num_steps_sampled": 35000, "sample_time_ms": 137991.328, "load_time_ms": 15.157, "grad_time_ms": 610.021, "update_time_ms": 87.606, "learner": {"default_policy": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 9.999999747378752e-06, "total_loss": 164.79747009277344, "policy_loss": -0.002558389212936163, "vf_loss": 164.79994201660156, "vf_explained_var": -0.003871154971420765, "kl": 0.005593756679445505, "entropy": 2.7471024990081787, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 35000, "episodes_total": 245, "training_iteration": 5, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_21-55-44", "timestamp": 1624593344, "time_this_iter_s": 134.0116903781891, "time_total_s": 693.7633402347565, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 693.7633402347565, "timesteps_since_restore": 35000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 88.76073298429321, "ram_util_percent": 32.54607329842931}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 79.62257127139793, "episode_reward_min": 64.12367172909109, "episode_reward_mean": 72.47003727528677, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 609.502066593662, "mean_processing_ms": 51.64643224303499, "mean_inference_ms": 1.004439679376623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 41472, "num_steps_sampled": 42000, "sample_time_ms": 138417.145, "load_time_ms": 12.935, "grad_time_ms": 599.127, "update_time_ms": 73.708, "learner": {"default_policy": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 9.999999747378752e-06, "total_loss": 153.0325927734375, "policy_loss": -0.002149029867723584, "vf_loss": 153.03468322753906, "vf_explained_var": -0.0037200881633907557, "kl": 0.004640606231987476, "entropy": 2.7451441287994385, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 42000, "episodes_total": 315, "training_iteration": 6, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_21-58-05", "timestamp": 1624593485, "time_this_iter_s": 141.11161255836487, "time_total_s": 834.8749527931213, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 834.8749527931213, "timesteps_since_restore": 42000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 88.90646766169155, "ram_util_percent": 32.8452736318408}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 79.62257127139793, "episode_reward_min": 64.12367172909109, "episode_reward_mean": 73.1605357273981, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 611.0251490586245, "mean_processing_ms": 51.923502815725406, "mean_inference_ms": 0.9999640980482392}, "off_policy_estimator": {}, "info": {"num_steps_trained": 48384, "num_steps_sampled": 49000, "sample_time_ms": 138345.416, "load_time_ms": 11.395, "grad_time_ms": 596.255, "update_time_ms": 63.739, "learner": {"default_policy": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 9.999999747378752e-06, "total_loss": 177.33248901367188, "policy_loss": -0.003836345858871937, "vf_loss": 177.33628845214844, "vf_explained_var": -0.0033030433114618063, "kl": 0.006033801939338446, "entropy": 2.7219529151916504, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 49000, "episodes_total": 350, "training_iteration": 7, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-00-23", "timestamp": 1624593623, "time_this_iter_s": 138.55934309959412, "time_total_s": 973.4342958927155, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 973.4342958927155, "timesteps_since_restore": 49000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 88.24999999999999, "ram_util_percent": 32.79343434343434}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 80.9224838361484, "episode_reward_min": 69.05176797251096, "episode_reward_mean": 75.04051640788893, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 613.8335273759535, "mean_processing_ms": 52.295736259191116, "mean_inference_ms": 0.9944382932781896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55296, "num_steps_sampled": 56000, "sample_time_ms": 138980.943, "load_time_ms": 10.21, "grad_time_ms": 594.144, "update_time_ms": 56.326, "learner": {"default_policy": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 9.999999747378752e-06, "total_loss": 180.88624572753906, "policy_loss": -0.0013583583058789372, "vf_loss": 180.8875732421875, "vf_explained_var": -0.0008537824614904821, "kl": 0.0028049531392753124, "entropy": 2.7009897232055664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 56000, "episodes_total": 420, "training_iteration": 8, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-02-47", "timestamp": 1624593767, "time_this_iter_s": 144.03213119506836, "time_total_s": 1117.4664270877838, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1117.4664270877838, "timesteps_since_restore": 56000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 87.7621359223301, "ram_util_percent": 32.946116504854366}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 84.19825406438403, "episode_reward_min": 69.05176797251096, "episode_reward_mean": 77.18331116173357, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 615.8581355731827, "mean_processing_ms": 54.62311132294744, "mean_inference_ms": 0.9950899052514453}, "off_policy_estimator": {}, "info": {"num_steps_trained": 62208, "num_steps_sampled": 63000, "sample_time_ms": 140021.49, "load_time_ms": 9.329, "grad_time_ms": 592.683, "update_time_ms": 50.559, "learner": {"default_policy": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 9.999999747378752e-06, "total_loss": 181.6830291748047, "policy_loss": -0.003650670638307929, "vf_loss": 181.68666076660156, "vf_explained_var": 5.4927888413658366e-05, "kl": 0.003189546288922429, "entropy": 2.665442943572998, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 63000, "episodes_total": 490, "training_iteration": 9, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-05-16", "timestamp": 1624593916, "time_this_iter_s": 148.94944787025452, "time_total_s": 1266.4158749580383, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1266.4158749580383, "timesteps_since_restore": 63000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 87.18113207547171, "ram_util_percent": 33.1872641509434}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 84.19825406438403, "episode_reward_min": 72.26866554713469, "episode_reward_mean": 78.17331736772584, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 617.0130019840565, "mean_processing_ms": 54.58999861695605, "mean_inference_ms": 0.9934031868561186}, "off_policy_estimator": {}, "info": {"num_steps_trained": 69120, "num_steps_sampled": 70000, "sample_time_ms": 139770.902, "load_time_ms": 8.581, "grad_time_ms": 591.186, "update_time_ms": 45.919, "learner": {"default_policy": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 9.999999747378752e-06, "total_loss": 195.24749755859375, "policy_loss": 0.0009221633081324399, "vf_loss": 195.24659729003906, "vf_explained_var": -0.00041037797927856445, "kl": 0.0027902587316930294, "entropy": 2.6941864490509033, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 70000, "episodes_total": 525, "training_iteration": 10, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-07-35", "timestamp": 1624594055, "time_this_iter_s": 138.11572456359863, "time_total_s": 1404.531599521637, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1404.531599521637, "timesteps_since_restore": 70000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 87.79289340101523, "ram_util_percent": 33.14416243654822}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 83.36772750196867, "episode_reward_min": 70.94762239096227, "episode_reward_mean": 78.83177958588237, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 618.3814826775425, "mean_processing_ms": 54.61803962644301, "mean_inference_ms": 0.9915798124959561}, "off_policy_estimator": {}, "info": {"num_steps_trained": 76032, "num_steps_sampled": 77000, "sample_time_ms": 140159.336, "load_time_ms": 5.452, "grad_time_ms": 564.863, "update_time_ms": 4.233, "learner": {"default_policy": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 9.999999747378752e-06, "total_loss": 168.51885986328125, "policy_loss": -0.0033662004861980677, "vf_loss": 168.52223205566406, "vf_explained_var": 1.725333640933968e-05, "kl": 0.0029941806569695473, "entropy": 2.644913673400879, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 77000, "episodes_total": 595, "training_iteration": 11, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-10-01", "timestamp": 1624594201, "time_this_iter_s": 146.40574026107788, "time_total_s": 1550.9373397827148, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1550.9373397827148, "timesteps_since_restore": 77000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 88.09712918660288, "ram_util_percent": 33.37129186602871}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 83.37418716289808, "episode_reward_min": 70.94762239096227, "episode_reward_mean": 79.10591763554483, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 619.4167380874028, "mean_processing_ms": 54.609549914105315, "mean_inference_ms": 0.9904582638478934}, "off_policy_estimator": {}, "info": {"num_steps_trained": 82944, "num_steps_sampled": 84000, "sample_time_ms": 139979.064, "load_time_ms": 5.495, "grad_time_ms": 571.988, "update_time_ms": 4.249, "learner": {"default_policy": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 202.06163024902344, "policy_loss": -0.003557329997420311, "vf_loss": 202.0651397705078, "vf_explained_var": -5.636502100969665e-05, "kl": 0.0049637844786047935, "entropy": 2.6123807430267334, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 84000, "episodes_total": 630, "training_iteration": 12, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-12-21", "timestamp": 1624594341, "time_this_iter_s": 139.72890377044678, "time_total_s": 1690.6662435531616, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1690.6662435531616, "timesteps_since_restore": 84000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 88.502, "ram_util_percent": 33.23650000000001}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 85.45648858886987, "episode_reward_min": 74.73240972151493, "episode_reward_mean": 80.63269703819739, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 621.302383827251, "mean_processing_ms": 54.698766865336026, "mean_inference_ms": 0.9913243161379559}, "off_policy_estimator": {}, "info": {"num_steps_trained": 89856, "num_steps_sampled": 91000, "sample_time_ms": 141400.259, "load_time_ms": 5.432, "grad_time_ms": 577.977, "update_time_ms": 4.284, "learner": {"default_policy": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 176.11802673339844, "policy_loss": -0.00045107994810678065, "vf_loss": 176.1184844970703, "vf_explained_var": -1.5921063095447607e-05, "kl": 0.004322333261370659, "entropy": 2.587998628616333, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 91000, "episodes_total": 700, "training_iteration": 13, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-14-48", "timestamp": 1624594488, "time_this_iter_s": 147.41766333580017, "time_total_s": 1838.0839068889618, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1838.0839068889618, "timesteps_since_restore": 91000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 88.06095238095237, "ram_util_percent": 33.511428571428574}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 87.19768107815646, "episode_reward_min": 74.73240972151493, "episode_reward_mean": 81.7573820547929, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 622.1849830208387, "mean_processing_ms": 54.69914144298885, "mean_inference_ms": 0.9903555850681854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 96768, "num_steps_sampled": 98000, "sample_time_ms": 141658.211, "load_time_ms": 5.532, "grad_time_ms": 583.762, "update_time_ms": 4.258, "learner": {"default_policy": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 218.78167724609375, "policy_loss": -0.003356244880706072, "vf_loss": 218.7850341796875, "vf_explained_var": 6.195350579218939e-05, "kl": 0.002742618089541793, "entropy": 2.565765619277954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 98000, "episodes_total": 735, "training_iteration": 14, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-17-13", "timestamp": 1624594633, "time_this_iter_s": 144.57891201972961, "time_total_s": 1982.6628189086914, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 1982.6628189086914, "timesteps_since_restore": 98000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 86.70388349514563, "ram_util_percent": 33.41699029126213}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 87.92749116690253, "episode_reward_min": 77.55758738293729, "episode_reward_mean": 83.24569479680441, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 623.6959860237911, "mean_processing_ms": 54.806122293190754, "mean_inference_ms": 0.9889543893793578}, "off_policy_estimator": {}, "info": {"num_steps_trained": 103680, "num_steps_sampled": 105000, "sample_time_ms": 142834.548, "load_time_ms": 2.143, "grad_time_ms": 589.917, "update_time_ms": 4.182, "learner": {"default_policy": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 9.999999747378752e-06, "total_loss": 195.17776489257812, "policy_loss": -0.002990682842209935, "vf_loss": 195.18077087402344, "vf_explained_var": 4.1180188418366015e-05, "kl": 0.00841979868710041, "entropy": 2.5327162742614746, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 105000, "episodes_total": 805, "training_iteration": 15, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-19-39", "timestamp": 1624594779, "time_this_iter_s": 145.7423369884491, "time_total_s": 2128.4051558971405, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2128.4051558971405, "timesteps_since_restore": 105000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 88.72740384615386, "ram_util_percent": 33.612019230769235}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 89.21686447454496, "episode_reward_min": 77.83635978969285, "episode_reward_mean": 84.50414920837594, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 625.3752996098597, "mean_processing_ms": 56.036098920819875, "mean_inference_ms": 0.9887598531791513}, "off_policy_estimator": {}, "info": {"num_steps_trained": 110592, "num_steps_sampled": 112000, "sample_time_ms": 144218.302, "load_time_ms": 2.161, "grad_time_ms": 598.208, "update_time_ms": 4.149, "learner": {"default_policy": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 216.5147247314453, "policy_loss": -0.0009345854050479829, "vf_loss": 216.51568603515625, "vf_explained_var": 2.8693013518932275e-05, "kl": 0.0019421151373535395, "entropy": 2.4987716674804688, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 112000, "episodes_total": 875, "training_iteration": 16, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-22-14", "timestamp": 1624594934, "time_this_iter_s": 155.03365898132324, "time_total_s": 2283.4388148784637, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2283.4388148784637, "timesteps_since_restore": 112000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 86.57330316742082, "ram_util_percent": 33.729864253393664}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 89.70821925814265, "episode_reward_min": 80.59021698163323, "episode_reward_mean": 85.14403178020397, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 626.3485696729085, "mean_processing_ms": 55.976229646271825, "mean_inference_ms": 0.9876317583978317}, "off_policy_estimator": {}, "info": {"num_steps_trained": 117504, "num_steps_sampled": 119000, "sample_time_ms": 144719.872, "load_time_ms": 2.12, "grad_time_ms": 603.193, "update_time_ms": 4.201, "learner": {"default_policy": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 230.17889404296875, "policy_loss": -0.0021655880846083164, "vf_loss": 230.18106079101562, "vf_explained_var": 5.969294761598576e-06, "kl": 0.004661924205720425, "entropy": 2.4488871097564697, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 119000, "episodes_total": 910, "training_iteration": 17, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-24-38", "timestamp": 1624595078, "time_this_iter_s": 143.58186197280884, "time_total_s": 2427.0206768512726, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2427.0206768512726, "timesteps_since_restore": 119000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 86.62097560975607, "ram_util_percent": 33.659512195121955}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 90.39224259089956, "episode_reward_min": 81.7675648387612, "episode_reward_mean": 86.2475385424826, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 627.8014640349511, "mean_processing_ms": 56.05182703485248, "mean_inference_ms": 0.9866151260990182}, "off_policy_estimator": {}, "info": {"num_steps_trained": 124416, "num_steps_sampled": 126000, "sample_time_ms": 145722.672, "load_time_ms": 2.143, "grad_time_ms": 608.263, "update_time_ms": 4.212, "learner": {"default_policy": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 9.999999747378752e-06, "total_loss": 200.41659545898438, "policy_loss": -0.002922086976468563, "vf_loss": 200.4195098876953, "vf_explained_var": -2.6625615646480583e-05, "kl": 0.0054892501793801785, "entropy": 2.411184549331665, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 126000, "episodes_total": 980, "training_iteration": 18, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-27-12", "timestamp": 1624595232, "time_this_iter_s": 154.10836100578308, "time_total_s": 2581.1290378570557, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2581.1290378570557, "timesteps_since_restore": 126000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 86.48363636363636, "ram_util_percent": 34.026363636363634}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 92.04194607932968, "episode_reward_min": 81.7675648387612, "episode_reward_mean": 86.99881335082513, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 628.6561700021205, "mean_processing_ms": 56.03948266226942, "mean_inference_ms": 0.9860406177513192}, "off_policy_estimator": {}, "info": {"num_steps_trained": 131328, "num_steps_sampled": 133000, "sample_time_ms": 145308.435, "load_time_ms": 2.123, "grad_time_ms": 613.209, "update_time_ms": 4.173, "learner": {"default_policy": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 9.999999747378752e-06, "total_loss": 236.63743591308594, "policy_loss": -0.004052905365824699, "vf_loss": 236.64149475097656, "vf_explained_var": 5.298632095218636e-05, "kl": 0.0018457095138728619, "entropy": 2.3911068439483643, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 133000, "episodes_total": 1015, "training_iteration": 19, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-29-37", "timestamp": 1624595377, "time_this_iter_s": 144.85689878463745, "time_total_s": 2725.985936641693, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2725.985936641693, "timesteps_since_restore": 133000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 88.156038647343, "ram_util_percent": 33.965700483091794}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 92.04194607932968, "episode_reward_min": 81.66664133232233, "episode_reward_mean": 87.52747566537384, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 630.7792342735794, "mean_processing_ms": 56.18154593411125, "mean_inference_ms": 0.9852980803916022}, "off_policy_estimator": {}, "info": {"num_steps_trained": 138240, "num_steps_sampled": 140000, "sample_time_ms": 146942.258, "load_time_ms": 2.113, "grad_time_ms": 614.996, "update_time_ms": 4.188, "learner": {"default_policy": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 9.999999747378752e-06, "total_loss": 193.97447204589844, "policy_loss": -0.0036261617206037045, "vf_loss": 193.97808837890625, "vf_explained_var": 2.4131049940478988e-05, "kl": 0.004900198429822922, "entropy": 2.3722593784332275, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 140000, "episodes_total": 1085, "training_iteration": 20, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-32-11", "timestamp": 1624595531, "time_this_iter_s": 154.47147846221924, "time_total_s": 2880.4574151039124, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 2880.4574151039124, "timesteps_since_restore": 140000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 87.53818181818183, "ram_util_percent": 34.26863636363637}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 91.49305814889723, "episode_reward_min": 81.66664133232233, "episode_reward_mean": 87.47522264882268, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 631.5660844721467, "mean_processing_ms": 56.18782145004882, "mean_inference_ms": 0.9853424020663882}, "off_policy_estimator": {}, "info": {"num_steps_trained": 145152, "num_steps_sampled": 147000, "sample_time_ms": 146813.464, "load_time_ms": 2.114, "grad_time_ms": 617.288, "update_time_ms": 4.174, "learner": {"default_policy": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 9.999999747378752e-06, "total_loss": 231.52383422851562, "policy_loss": 0.0001324826298514381, "vf_loss": 231.52369689941406, "vf_explained_var": 1.6924408555496484e-05, "kl": 0.0026422222144901752, "entropy": 2.299943685531616, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 147000, "episodes_total": 1120, "training_iteration": 21, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-34-36", "timestamp": 1624595676, "time_this_iter_s": 145.0292727947235, "time_total_s": 3025.486687898636, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3025.486687898636, "timesteps_since_restore": 147000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 87.96811594202899, "ram_util_percent": 34.197584541062795}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 90.741049739853, "episode_reward_min": 83.24915172068528, "episode_reward_mean": 87.15648656444577, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 633.1243008741258, "mean_processing_ms": 56.27116367553052, "mean_inference_ms": 0.9853649356351961}, "off_policy_estimator": {}, "info": {"num_steps_trained": 152064, "num_steps_sampled": 154000, "sample_time_ms": 147932.883, "load_time_ms": 5.907, "grad_time_ms": 616.017, "update_time_ms": 4.149, "learner": {"default_policy": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 197.50189208984375, "policy_loss": -0.00328369764611125, "vf_loss": 197.50518798828125, "vf_explained_var": -2.0011707420053426e-06, "kl": 0.0028397603891789913, "entropy": 2.3398478031158447, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 154000, "episodes_total": 1190, "training_iteration": 22, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-37-07", "timestamp": 1624595827, "time_this_iter_s": 150.94844841957092, "time_total_s": 3176.435136318207, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3176.435136318207, "timesteps_since_restore": 154000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 88.8906976744186, "ram_util_percent": 34.239999999999995}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 91.65940792891867, "episode_reward_min": 81.01159511731078, "episode_reward_mean": 87.26980332053543, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 633.8655872656251, "mean_processing_ms": 56.261448817409125, "mean_inference_ms": 0.9851761766429007}, "off_policy_estimator": {}, "info": {"num_steps_trained": 158976, "num_steps_sampled": 161000, "sample_time_ms": 148037.28, "load_time_ms": 5.875, "grad_time_ms": 616.958, "update_time_ms": 4.134, "learner": {"default_policy": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 235.66709899902344, "policy_loss": -0.0018459171988070011, "vf_loss": 235.66897583007812, "vf_explained_var": 4.017794708488509e-06, "kl": 0.006904255133122206, "entropy": 2.2847306728363037, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 161000, "episodes_total": 1225, "training_iteration": 23, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-39-36", "timestamp": 1624595976, "time_this_iter_s": 148.47346353530884, "time_total_s": 3324.9085998535156, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3324.9085998535156, "timesteps_since_restore": 161000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 87.13632075471698, "ram_util_percent": 34.24339622641509}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 91.65940792891867, "episode_reward_min": 81.01159511731078, "episode_reward_mean": 87.54842536113868, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 635.4358977348462, "mean_processing_ms": 56.363745650787166, "mean_inference_ms": 0.9845599951751817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 165888, "num_steps_sampled": 168000, "sample_time_ms": 148714.39, "load_time_ms": 5.916, "grad_time_ms": 617.841, "update_time_ms": 4.165, "learner": {"default_policy": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 224.02127075195312, "policy_loss": -0.0012186288367956877, "vf_loss": 224.0224609375, "vf_explained_var": 4.3323748286638875e-06, "kl": 0.0015584288630634546, "entropy": 2.341041088104248, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 168000, "episodes_total": 1295, "training_iteration": 24, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-42-07", "timestamp": 1624596127, "time_this_iter_s": 151.3580505847931, "time_total_s": 3476.2666504383087, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3476.2666504383087, "timesteps_since_restore": 168000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 88.41944444444444, "ram_util_percent": 34.11435185185185}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 91.92682756144326, "episode_reward_min": 84.77714112878823, "episode_reward_mean": 88.03476234362137, "episode_len_mean": 128.0, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 636.6270883621885, "mean_processing_ms": 57.17978765389148, "mean_inference_ms": 0.984905286971898}, "off_policy_estimator": {}, "info": {"num_steps_trained": 172800, "num_steps_sampled": 175000, "sample_time_ms": 149905.282, "load_time_ms": 5.898, "grad_time_ms": 617.255, "update_time_ms": 4.222, "learner": {"default_policy": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 9.999999747378752e-06, "total_loss": 205.06451416015625, "policy_loss": -0.0012058692518621683, "vf_loss": 205.06565856933594, "vf_explained_var": -3.358832145750057e-06, "kl": 0.0064261979423463345, "entropy": 2.2970964908599854, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 175000, "episodes_total": 1365, "training_iteration": 25, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-44-45", "timestamp": 1624596285, "time_this_iter_s": 157.62293219566345, "time_total_s": 3633.889582633972, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3633.889582633972, "timesteps_since_restore": 175000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 86.7071111111111, "ram_util_percent": 34.36977777777778}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
{"episode_reward_max": 91.92682756144326, "episode_reward_min": 85.09512777482031, "episode_reward_mean": 88.31859233754963, "episode_len_mean": 128.0, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 637.3518734979725, "mean_processing_ms": 57.148904659508844, "mean_inference_ms": 0.9838544624475445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179712, "num_steps_sampled": 182000, "sample_time_ms": 149069.129, "load_time_ms": 5.868, "grad_time_ms": 614.482, "update_time_ms": 4.235, "learner": {"default_policy": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 9.999999747378752e-06, "total_loss": 237.11212158203125, "policy_loss": -0.002050225855782628, "vf_loss": 237.11412048339844, "vf_explained_var": 2.229655137853115e-06, "kl": 0.0011656604474410415, "entropy": 2.298011064529419, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 7000, "done": false, "timesteps_total": 182000, "episodes_total": 1400, "training_iteration": 26, "experiment_id": "72080b91cb474c788b6a0d73cb65019b", "date": "2021-06-24_22-47-11", "timestamp": 1624596431, "time_this_iter_s": 146.69850206375122, "time_total_s": 3780.5880846977234, "pid": 143392, "hostname": "r2i3n35", "node_ip": "10.148.4.97", "config": {"num_workers": 35, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 128, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64, 64], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 128, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"action_high\": 1,\n            \"action_low\": -1,\n            \"actions\": 2,\n            \"checkpoint_freq\": 10,\n            \"exp_config\": \"merge\",\n            \"exp_tag\": \"refactor.5\",\n            \"fcnet_hiddens\": [\n                64,\n                64,\n                64\n            ],\n            \"flow_bottom\": 2500,\n            \"flow_left\": 5000,\n            \"history_maxlen\": 40,\n            \"horizon\": 128,\n            \"learn_percent\": 1,\n            \"lr\": 1e-05,\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_failures\": 1000,\n            \"n_rollouts\": 1,\n            \"reward\": {\n                \"include\": {\n                    \"fewer_stopped_cars\": 0,\n                    \"larger_mean_outflow\": 1,\n                    \"larger_mean_speed\": 0\n                },\n                \"stop_threshold\": 1,\n                \"weights\": {\n                    \"bottom\": 0.75,\n                    \"center\": 0,\n                    \"left\": 0.25\n                }\n            },\n            \"sims_per_step\": 40,\n            \"state\": {\n                \"max_outflow\": {\n                    \"bottom\": 1125,\n                    \"center\": 3500,\n                    \"left\": 3500\n                },\n                \"max_speed\": {\n                    \"bottom\": 30,\n                    \"center\": 30,\n                    \"left\": 30\n                },\n                \"observations\": [\n                    \"speed\"\n                ],\n                \"segments\": [\n                    \"left\",\n                    \"bottom\"\n                ]\n            },\n            \"training_iteration\": 200,\n            \"warmup_steps\": 5\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 128,\n        \"sims_per_step\": 40,\n        \"warmup_steps\": 5\n    },\n    \"env_name\": \"configs.merge.environment.MergeEnvironment\",\n    \"exp_tag\": \"refactor.5\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 2,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_highway_0\",\n                    \"vehsPerHour\": 5000,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": \"max\",\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 86400,\n                    \"name\": \"rl_inflow_merge_1\",\n                    \"vehsPerHour\": 2500,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"configs.merge.network.MergeNetwork\",\n    \"sim\": {\n        \"color_by_speed\": false,\n        \"emission_path\": \"./data/\",\n        \"force_color_update\": false,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1,\n        \"use_ballistic\": false\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "MergeEnvironment-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 1e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {}, "policy_mapping_fn": null, "policies_to_train": null}, "use_gae": true, "lambda": 0.97, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 10, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10, "grad_clip": null, "kl_target": 0.02, "simple_optimizer": false}, "time_since_restore": 3780.5880846977234, "timesteps_since_restore": 182000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 87.9377990430622, "ram_util_percent": 34.33444976076555}, "num_healthy_workers": 35, "trial_id": "bb984c82", "experiment_tag": "0"}
